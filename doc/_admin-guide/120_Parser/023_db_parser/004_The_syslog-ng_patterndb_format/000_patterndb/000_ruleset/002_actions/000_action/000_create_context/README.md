---
title: 'Element: create-context'
short_title: create-context
id: adm-parser-db-elem-create-context
---

## Location

/ patterndb / ruleset / actions / action / create-context

## Description

OPTIONAL --- Creates a new correlation context from the current message
and its associated context. This can be used to \"split\" a context.

Available in syslog-ng OSE version 3.8 and later.

## Attributes

- *context-id*: OPTIONAL --- An identifier to group related log
    messages when using the pattern database to correlate events. The ID
    can be a descriptive string describing the events related to the log
    message (for example, ssh-sessions for log messages related to SSH
    traffic), but can also contain macros to generate IDs dynamically.
    When using macros in IDs, see also the context-scope attribute.
    Starting with syslog-ng OSE version 3.5, if a message is added to a
    context, syslog-ng OSE automatically adds the identifier of the
    context to the .classifier.context\_id macro of the message. For
    details on correlating messages, see
    [[Correlating log messages using pattern databases]].

    **NOTE:** The syslog-ng OSE application determines the context of the
    message *after* the pattern matching is completed. This means that
    macros and name-value pairs created by the matching pattern database
    rule can be used as context-id macros.
    {: .notice--info}

- *context-timeout*: OPTIONAL --- The number of seconds the context is
    stored. Note that for high-traffic log servers, storing open
    contexts for long time can require significant amount of memory. For
    details on correlating messages, see
    [[Correlating log messages using pattern databases]].

- *context-scope*: OPTIONAL --- Specifies which messages belong to the
    same context. This attribute is used to determine the context of the
    message if the context-id does not specify any macros. Usually,
    context-scope acts a filter for the context, with context-id
    refining the filtering if needed. The following values are
    available:

  - *process*: Only messages that are generated by the same process
        of a client belong to the same context, that is, messages that
        have identical \${HOST}, \${PROGRAM} and \${PID} values. This is
        the default behavior of syslog-ng OSE if context-scope is not
        specified.

  - *program*: Messages that are generated by the same application
        of a client belong to the same context, that is, messages that
        have identical \${HOST} and \${PROGRAM} values.

  - *host*: Every message generated by a client belongs to the same
        context, only the \${HOST} value of the messages must be
        identical.

  - *global*: Every message belongs to the same context.

    **NOTE:** Using the context-scope attribute is significantly faster than
    using macros in the context-id attribute.
    {: .notice--info}

    For details on correlating messages, see
    [[Correlating log messages using pattern databases]].

## Children

- *message*: A container element storing the message that is added to
    the new context when the action is executed.

  - *inherit-mode*: This attribute controls which name-value pairs
        and tags are propagated to the newly generated message.

    - context: syslog-ng OSE collects every name-value pair from
            each message stored in the context, and includes them in the
            generated message. If a name-value pair appears in multiple
            messages of the context, the value in the latest message
            will be used. Note that tags are not merged, the generated
            message will inherit the tags assigned to the last message
            of the context.

    - last-message: Only the name-value pairs appearing in the
            last message are copied. If the context contains only a
            single message, then it is the message that triggered the
            action.

    - none: An empty message is created, without inheriting any
            tags or name-value pairs.

        For details on the message context, see
        [[Correlating log messages using pattern databases]]
        and [[Actions and message correlation]].
        For details on triggering messages, see
        [[Triggering actions for identified messages]].

### Example

The following example creates a new context whenever the rule matches.
The new context receives **1000** as ID, and **program** as scope, and
the content set in the \<message\> element of the \<create-context\>
element.

```xml
<rule provider='test' id='12' class='violation'>
  <patterns>
    <pattern>simple-message-with-action-to-create-context</pattern>
  </patterns>
  <actions>
    <action trigger='match'>
      <create-context context-id='1000' context-timeout='60' context-scope='program'>
        <message inherit-properties='context'>
          <values>
            <value name='MESSAGE'>context message</value>
          </values>
        </message>
      </create-context>
    </action>
  </actions>
</rule>
```
